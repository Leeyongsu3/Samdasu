fileFormatVersion: 2
guid: 3be1c2c1aae678e448df397858364ca9
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst UnityEngine_1 = require(\"UnityEngine\");\r\nconst
    ZEPETO_Character_Controller_1 = require(\"ZEPETO.Character.Controller\");\r\nconst
    ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst GameManager_1 = require(\"../Managers/GameManager\");\r\nconst
    TypeManager_1 = require(\"../Managers/TypeManager\");\r\nclass HorseRideManager
    extends ZEPETO_Script_1.ZepetoScriptBehaviour {\r\n    constructor() {\r\n       
    super(...arguments);\r\n        this.horseRiders = [];\r\n    }\r\n    get localSessionId()
    { return this._localSessionId; }\r\n    set localSessionId(value) {\r\n       
    if (this._localSessionId == null && value) {\r\n            this._localSessionId
    = value;\r\n        }\r\n    }\r\n    /* Async Player and Horse Animation */\r\n   
    FixedUpdate() {\r\n        if (!this.horseRiders)\r\n            return;\r\n       
    for (const rider of this.horseRiders) {\r\n            if (!rider)\r\n               
    continue;\r\n            if (!ZEPETO_Character_Controller_1.ZepetoPlayers.instance.HasPlayer(rider.sessionId))
    {\r\n                /* Return Horse */\r\n                const index = this.horseRiders.indexOf(rider);\r\n               
    this.horseRiders.splice(index, 1);\r\n                /* Input Horse Group */\r\n               
    rider.horse.transform.SetParent(this.horsePoolGroup);\r\n                rider.horse.transform.position
    = this.horsePoolGroup.position;\r\n                rider.horse.transform.rotation
    = this.horsePoolGroup.rotation;\r\n                rider.horse.SetActive(false);\r\n               
    continue;\r\n            }\r\n            /* Riding Start */\r\n            if
    (rider.ownerAnimator.GetInteger(TypeManager_1.Anim.SamdasuState) == TypeManager_1.SamdasuState.Ride_Horse)\r\n               
    rider.startRiding = true;\r\n            /* isRiding */\r\n            if (rider.startRiding)
    {\r\n                if (rider.ownerAnimator.GetInteger(TypeManager_1.Anim.SamdasuState)
    == TypeManager_1.SamdasuState.Ride_Horse) {\r\n                    rider.horseAnimator.SetInteger(TypeManager_1.Anim.State,
    rider.ownerAnimator.GetInteger(TypeManager_1.Anim.State));\r\n               
    }\r\n                else {\r\n                    rider.horseAnimator.SetInteger(TypeManager_1.Anim.State,
    1);\r\n                    GameManager_1.default.instance.RideOFFHorse(rider.sessionId);\r\n               
    }\r\n            }\r\n        }\r\n    }\r\n    /* Ride ON Horse */\r\n    RideHorse(sessionId,
    localSessionId) {\r\n        if (!ZEPETO_Character_Controller_1.ZepetoPlayers.instance.HasPlayer(sessionId))\r\n           
    return;\r\n        /* Init */\r\n        if (!this.horseRiders)\r\n           
    this.horseRiders = [];\r\n        /* Player Setting */\r\n        const character
    = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId).character;\r\n       
    const playerSoket = character.transform.GetChild(0).GetChild(3);\r\n        character.additionalRunSpeed
    = 1;\r\n        character.additionalWalkSpeed = 0.5;\r\n        /* Player State
    Set */\r\n        this.localSessionId = localSessionId;\r\n        if (this.localSessionId
    == sessionId)\r\n            GameManager_1.default.instance.SetSamdasuState(TypeManager_1.SamdasuState.Ride_Horse,
    true);\r\n        /* Get Horse */\r\n        const horse = this.GetHorse(playerSoket);\r\n       
    /* Horse Setting */\r\n        const horseRider = {\r\n            sessionId:
    sessionId,\r\n            horse: horse,\r\n            horseAnimator: horse.transform.GetChild(0).GetComponent($typeof(UnityEngine_1.Animator)),\r\n           
    ownerAnimator: character.ZepetoAnimator,\r\n            startRiding: false,\r\n       
    };\r\n        this.horseRiders.push(horseRider);\r\n    }\r\n    /* Ride OFF
    Horse */\r\n    RideOFFHorse(sessionId) {\r\n        /* Player Setting */\r\n       
    const character = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId).character;\r\n       
    character.additionalRunSpeed = 0;\r\n        character.additionalWalkSpeed =
    0;\r\n        /* Player State Set */\r\n        if (this.localSessionId == sessionId)\r\n           
    GameManager_1.default.instance.SetSamdasuState(TypeManager_1.SamdasuState.Ride_Horse,
    false);\r\n        /* Return Horse */\r\n        this.ReturnHorse(sessionId);\r\n   
    }\r\n    /* Get Horse */\r\n    GetHorse(setParent) {\r\n        /* Find or Create
    Usable Horse */\r\n        let horse = this.FindUsableHorse();\r\n        if
    (!horse)\r\n            horse = this.InstantiateHorse();\r\n        /* Set Data
    */\r\n        horse.SetActive(true);\r\n        horse.transform.SetParent(setParent);\r\n       
    horse.transform.localScale = UnityEngine_1.Vector3.one;\r\n        horse.transform.localRotation
    = UnityEngine_1.Quaternion.identity;\r\n        horse.transform.localPosition
    = UnityEngine_1.Vector3.op_Multiply(UnityEngine_1.Vector3.forward, 0.3);\r\n       
    return horse;\r\n    }\r\n    /* Return Horse */\r\n    ReturnHorse(sessionId)
    {\r\n        /* Find Horse */\r\n        const horse = this.OutputHorseInHorseRider(sessionId);\r\n       
    if (!horse)\r\n            return console.error(TypeManager_1.ERROR.NOT_FOUND_HORSE);\r\n       
    /* Input Horse Group */\r\n        horse.transform.SetParent(this.horsePoolGroup);\r\n       
    horse.transform.position = this.horsePoolGroup.position;\r\n        horse.transform.rotation
    = this.horsePoolGroup.rotation;\r\n        horse.SetActive(false);\r\n    }\r\n   
    /* Find Usable Horse */\r\n    FindUsableHorse() {\r\n        if (this.horsePool
    && this.horsePool.length > 0) {\r\n            for (const horse of this.horsePool)
    {\r\n                if (!horse.activeSelf && horse.transform.parent == this.horsePoolGroup)
    {\r\n                    return horse;\r\n                }\r\n            }\r\n       
    }\r\n        return null;\r\n    }\r\n    /* Find and Remove Horse in HorseRider
    */\r\n    OutputHorseInHorseRider(sessionId) {\r\n        for (let i = 0; i <
    this.horseRiders.length; i++) {\r\n            if (this.horseRiders[i].sessionId
    == sessionId) {\r\n                const horseRider = this.horseRiders[i];\r\n               
    this.horseRiders.splice(i, 1);\r\n                return horseRider.horse;\r\n           
    }\r\n        }\r\n        return null;\r\n    }\r\n    /* Instantiate Horse */\r\n   
    InstantiateHorse() {\r\n        if (!this.horsePool)\r\n            this.horsePool
    = [];\r\n        const horseClone = UnityEngine_1.GameObject.Instantiate(this.horsePrefab);\r\n       
    this.horsePool.push(horseClone);\r\n        return horseClone;\r\n    }\r\n}\r\nexports.default
    = HorseRideManager;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSG9yc2VSaWRlTWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkhvcnNlUmlkZU1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBbUY7QUFDbkYsNkVBQTREO0FBQzVELGlEQUFxRDtBQUNyRCx5REFBa0Q7QUFDbEQseURBQWdGO0FBRWhGLE1BQXFCLGdCQUFpQixTQUFRLHFDQUFxQjtJQUFuRTs7UUFPWSxnQkFBVyxHQUFpQixFQUFFLENBQUM7SUFvSjNDLENBQUM7SUFsSkcsSUFBVyxjQUFjLEtBQWEsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztJQUNwRSxJQUFXLGNBQWMsQ0FBQyxLQUFhO1FBQ25DLElBQUcsSUFBSSxDQUFDLGVBQWUsSUFBSSxJQUFJLElBQUksS0FBSyxFQUFFO1lBQ3RDLElBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDO1NBQ2hDO0lBQ0wsQ0FBQztJQUVELHNDQUFzQztJQUN0QyxXQUFXO1FBQ1AsSUFBRyxDQUFDLElBQUksQ0FBQyxXQUFXO1lBQUUsT0FBTztRQUM3QixLQUFJLE1BQU0sS0FBSyxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDakMsSUFBRyxDQUFDLEtBQUs7Z0JBQUUsU0FBUztZQUNwQixJQUFHLENBQUMsMkNBQWEsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsRUFBRTtnQkFDbkQsa0JBQWtCO2dCQUNsQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDOUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUVsQyx1QkFBdUI7Z0JBQ3ZCLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQ3JELEtBQUssQ0FB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","assetPath":"Assets/Zepeto
    Multiplay Component/ZepetoScript/SamdasuScript/HorseRideManager.ts","manifest":{"properties":[{"assembly":"UnityEngine.CoreModule","name":"horsePrefab","type":"UnityEngine.GameObject","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"Header","args":["\"Samdasus
    Field\""]},{"name":"SerializeField","args":[]}]},{"assembly":"UnityEngine.CoreModule","name":"horsePoolGroup","type":"UnityEngine.Transform","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"SerializeField","args":[]}]}],"name":"HorseRideManager","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: 20702ea95f1bc8228bda0abcd47a93bb
  onlyWriteTrigger: 0
